{% extends 'base.html' %}
{% block title %}Verify OTP | StyleHaven{% endblock %}

{% block content %}
<div class="min-h-[80vh] flex items-center justify-center bg-[#f9f8f4]">
    <div class="bg-white w-full max-w-md p-10 rounded-2xl shadow-xl border border-stone-100 text-center">
        
        <h2 class="text-3xl font-serif font-bold text-stone-800 mb-2">Verify It's You</h2>
        <p class="text-stone-500 text-sm mb-6">
            We sent a code to <span class="font-bold text-[#4a5d23]">{{ email }}</span>.
            <br>Enter it below to access your account.
        </p>

        {% if error %}
        <div class="bg-red-50 text-red-500 text-xs font-bold p-3 rounded-lg mb-6">
            {{ error }}
        </div>
        {% endif %}

        <form method="POST" action="{% url 'verify_otp' %}" class="flex flex-col gap-6">
            {% csrf_token %}
            
            <div class="flex justify-center gap-3" id="otp-inputs">
                <input type="text" name="otp1" maxlength="1" class="otp-box w-12 h-14 text-center text-xl font-bold border border-stone-300 rounded-lg focus:border-[#4a5d23] focus:ring-2 focus:ring-[#4a5d23]/20 outline-none transition" oninput="moveToNext(this, 'otp2')" id="otp1">
                <input type="text" name="otp2" maxlength="1" class="otp-box w-12 h-14 text-center text-xl font-bold border border-stone-300 rounded-lg focus:border-[#4a5d23] focus:ring-2 focus:ring-[#4a5d23]/20 outline-none transition" oninput="moveToNext(this, 'otp3')" id="otp2">
                <input type="text" name="otp3" maxlength="1" class="otp-box w-12 h-14 text-center text-xl font-bold border border-stone-300 rounded-lg focus:border-[#4a5d23] focus:ring-2 focus:ring-[#4a5d23]/20 outline-none transition" oninput="moveToNext(this, 'otp4')" id="otp3">
                <input type="text" name="otp4" maxlength="1" class="otp-box w-12 h-14 text-center text-xl font-bold border border-stone-300 rounded-lg focus:border-[#4a5d23] focus:ring-2 focus:ring-[#4a5d23]/20 outline-none transition" oninput="moveToNext(this, null)" id="otp4">
            </div>

            <button type="submit" class="w-full bg-[#4a5d23] text-white font-bold py-4 rounded-lg shadow-lg hover:bg-[#364419] transition uppercase tracking-widest text-xs">
                Verify & Login
            </button>
        </form>

        <p class="mt-6 text-xs text-stone-400">
            Didn't receive it? <a href="{% url 'login' %}" class="text-[#4a5d23] font-bold hover:underline">Resend OTP</a>
        </p>
    </div>
</div>

<script>
    function moveToNext(current, nextFieldID) {
        if (current.value.length >= 1) {
            if (nextFieldID) {
                document.getElementById(nextFieldID).focus();
            }
        }
    }
</script>
{% endblock %}